# Cronos - Linux

Difficulty: 1

## Enumeration

nmap scan

```jsx
â”Œâ”€â”€(kaliã‰¿kali)-[~/hackthebox/cronos]
â””â”€$ threader3000
------------------------------------------------------------
        Threader 3000 - Multi-threaded Port Scanner
                       Version 1.0.7
                   A project by The Mayor
------------------------------------------------------------
Enter your target IP address or URL here: 10.10.10.13
------------------------------------------------------------
Scanning target 10.10.10.13
Time started: 2021-09-16 07:14:36.522965
------------------------------------------------------------
Port 22 is open
Port 53 is open
Port 80 is open
Port scan completed in 0:01:39.087131
------------------------------------------------------------
Threader3000 recommends the following Nmap scan:
************************************************************
nmap -p22,53,80 -sV -sC -T4 -Pn -oA 10.10.10.13 10.10.10.13
************************************************************
Would you like to run Nmap or quit to terminal?
------------------------------------------------------------
1 = Run suggested Nmap scan
2 = Run another Threader3000 scan
3 = Exit to terminal
------------------------------------------------------------
Option Selection: 1
nmap -p22,53,80 -sV -sC -T4 -Pn -oA 10.10.10.13 10.10.10.13
Host discovery disabled (-Pn). All addresses will be marked 'up' and scan times will be slower.
Starting Nmap 7.91 ( https://nmap.org ) at 2021-09-16 07:16 EDT
Nmap scan report for cronos.htb (10.10.10.13)
Host is up (0.18s latency).

PORT   STATE SERVICE VERSION
22/tcp open  ssh     OpenSSH 7.2p2 Ubuntu 4ubuntu2.1 (Ubuntu Linux; protocol 2.0)
| ssh-hostkey:
|   2048 18:b9:73:82:6f:26:c7:78:8f:1b:39:88:d8:02:ce:e8 (RSA)
|   256 1a:e6:06:a6:05:0b:bb:41:92:b0:28:bf:7f:e5:96:3b (ECDSA)
|_  256 1a:0e:e7:ba:00:cc:02:01:04:cd:a3:a9:3f:5e:22:20 (ED25519)
53/tcp open  domain  ISC BIND 9.10.3-P4 (Ubuntu Linux)
| dns-nsid:
|_  bind.version: 9.10.3-P4-Ubuntu
80/tcp open  http    Apache httpd 2.4.18 ((Ubuntu))
|_http-server-header: Apache/2.4.18 (Ubuntu)
|_http-title: Cronos
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 18.46 seconds
------------------------------------------------------------
Combined scan completed in 0:02:01.562941
Press enter to quit...
```

For DNS enumeration, the first thing to do is try to resolve the IPs of Cronos. Iâ€™ll use nslookup, setting the server to Cronos, and then looking up Cronosâ€™ IP:

```jsx
root@kali# nslookup
server 10.10.10.13
Default server: 10.10.10.13
Address: 10.10.10.13#53
10.10.10.13
13.10.10.10.in-addr.arpa        name = ns1.cronos.htb.
```

Knowing the domain `ns1.cronos.htb` is useful, as it not only provides a domain name to poke at, but also confirms the base domain `cronos.htb`.

<aside>
ðŸ’¡ Any time thereâ€™s TCP DNS, itâ€™s worth trying a zone transfer, which returns another two subdomains, admin and www:

</aside>

```bash
root@kali# dig axfr cronos.htb @10.10.10.13

; <<>> DiG 9.11.16-2-Debian <<>> axfr cronos.htb @10.10.10.13
;; global options: +cmd
cronos.htb.             604800  IN      SOA     cronos.htb. admin.cronos.htb. 3 604800 86400 2419200 604800
cronos.htb.             604800  IN      NS      ns1.cronos.htb.
cronos.htb.             604800  IN      A       10.10.10.13
admin.cronos.htb.       604800  IN      A       10.10.10.13
ns1.cronos.htb.         604800  IN      A       10.10.10.13
www.cronos.htb.         604800  IN      A       10.10.10.13
cronos.htb.             604800  IN      SOA     cronos.htb. admin.cronos.htb. 3 604800 86400 2419200 604800
;; Query time: 14 msec
;; SERVER: 10.10.10.13#53(10.10.10.13)
;; WHEN: Tue Apr 07 21:08:57 EDT 2020
;; XFR size: 7 records (messages 1, bytes 203)
```

gobuster scan

```jsx
root@kali# gobuster dns -d cronos.htb -w /usr/share/seclists/Discovery/DNS/bitquark-subdomains-top100000.txt 
===============================================================
Gobuster v3.0.1
by OJ Reeves (@TheColonial) & Christian Mehlmauer (@_FireFart_)
===============================================================
[+] Domain:     cronos.htb
[+] Threads:    10
[+] Timeout:    1s
[+] Wordlist:   /usr/share/seclists/Discovery/DNS/bitquark-subdomains-top100000.txt
===============================================================
2020/04/08 06:32:15 Starting gobuster
===============================================================
Found: ns1.cronos.htb
Found: www.cronos.htb
Found: admin.cronos.htb
===============================================================
2020/04/08 06:34:22 Finished
===============================================================
```

## Initial Access

![Untitled](Cronos%20-%20Linux%20b4cc92822b4c4b19b822b397f3ea4597/Untitled.png)

```bash
www-data@cronos:/var/www/admin$ cat .welcome.php.swp
cat .welcome.php.swp
b0nano 2.5.3Ztrootcronos/var/www/admin/welcome.phpUwww-data@cronos:/var/www/admin$
```

```bash
www-data@cronos:/var/www/admin$ cat config.php
<?php
   define('DB_SERVER', 'localhost');
   define('DB_USERNAME', 'admin');
   define('DB_PASSWORD', 'kEjdbRigfBHUREiNSDs');
   define('DB_DATABASE', 'admin');
   $db = mysqli_connect(DB_SERVER,DB_USERNAME,DB_PASSWORD,DB_DATABASE);
?>
```

## Privilege Escalation

```bash
www-data@cronos:/$ cat /etc/crontab
# /etc/crontab: system-wide crontab
# Unlike any other crontab you don't have to run the `crontab'
# command to install the new version when you edit this file
# and files in /etc/cron.d. These files also have username fields,
# that none of the other crontabs do.

SHELL=/bin/sh
PATH=/usr/local/sbin:/usr/local/bin:/sbin:/bin:/usr/sbin:/usr/bin

# m h dom mon dow user  command
17 *    * * *   root    cd / && run-parts --report /etc/cron.hourly
25 6    * * *   root    test -x /usr/sbin/anacron || ( cd / && run-parts --report /etc/cron.daily )
47 6    * * 7   root    test -x /usr/sbin/anacron || ( cd / && run-parts --report /etc/cron.weekly )
52 6    1 * *   root    test -x /usr/sbin/anacron || ( cd / && run-parts --report /etc/cron.monthly )
* * * * *       root    php /var/www/laravel/artisan schedule:run >> /dev/null 2>&1
#
```

replaced the /var/www/laravel/artisan file with a php reverse shell script and gained root shell