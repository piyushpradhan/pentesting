# Racecar
Writeup link; https://shakuganz.com/2021/09/21/hackthebox-racecar-write-up/
- Format string vulnerability discovered
![](../Images/Pasted%20image%2020220329121455.png)
	- on lines: 
	```
	read(0, _format, 0x170);
	printf(_format);
	```
- Exploiting this vuln, we can print the pointer addresses using `%p` specifier
> Why can't 0x41414141 be displayed in char pointer and can be displayed in a char array (string) ?
- `_stream` variable stores the contents of "flag.txt"
- Check how much offset is required to reach the `_format` variable and print the value stored in it
![](../Images/Pasted%20image%2020220329122158.png)
- here `local_3c` stores the contents of the file "flag.txt"
- Checking the state of the registers and variables right before the contents of "flag.txt" are read
![](../Images/Pasted%20image%2020220329130050.png)
- the address of the last  `printf` statement is 0x00001002
- After setting a break point at 0x00001002 or car_menu+81 and providing some input I found this value in the stack, which is something I stored in my "flag.txt" locally too 
- So, it's possible that the value of "flag.txt" is being stored here, in the stack, I'm going to try a few more things to make sure this is correct and not just some accident
![](../Images/Pasted%20image%2020220329132320.png)
- This time I put "BBBB AAAA" in my flag.txt file
![](../Images/Pasted%20image%2020220329132629.png)
- And with this, I'm pretty confident that the flag is being stored here.
- Also, it starts from the same address "0xffffd0c0"
Now, how do I find it from the deployed server ? 
![](../Images/Pasted%20image%2020220329213114.png)
![](../Images/Pasted%20image%2020220329213613.png)
![](../Images/Pasted%20image%2020220329214059.png)
![](../Images/Pasted%20image%2020220329214157.png)