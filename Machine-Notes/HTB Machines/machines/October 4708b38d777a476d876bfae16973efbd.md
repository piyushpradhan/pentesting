# October

Difficulty: 6
Tags: Buffer Overflow, CMS, Linux, OctoberCMS
Type: Linux

# Enumeration

portscan 

```bash
# Nmap 7.91 scan initiated Fri Oct  8 08:57:09 2021 as: nmap -p22,80 -T4 -sC -sV -Pn -A -oN portscan 10.10.10.16
Nmap scan report for october.htb (10.10.10.16)
Host is up (0.25s latency).

PORT   STATE SERVICE VERSION
22/tcp open  ssh     OpenSSH 6.6.1p1 Ubuntu 2ubuntu2.8 (Ubuntu Linux; protocol 2.0)
| ssh-hostkey: 
|   1024 79:b1:35:b6:d1:25:12:a3:0c:b5:2e:36:9c:33:26:28 (DSA)
|   2048 16:08:68:51:d1:7b:07:5a:34:66:0d:4c:d0:25:56:f5 (RSA)
|   256 e3:97:a7:92:23:72:bf:1d:09:88:85:b6:6c:17:4e:85 (ECDSA)
|_  256 89:85:90:98:20:bf:03:5d:35:7f:4a:a9:e1:1b:65:31 (ED25519)
80/tcp open  http    Apache httpd 2.4.7 ((Ubuntu))
| http-methods: 
|_  Potentially risky methods: PUT PATCH DELETE
|_http-title: October CMS - Vanilla
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
# Nmap done at Fri Oct  8 08:57:58 2021 -- 1 IP address (1 host up) scanned in 48.69 seconds
```

- dirscan

```bash
/blog                 (Status: 200) [Size: 4254]
/index.php            (Status: 200) [Size: 5162]
/forum                (Status: 200) [Size: 9589]
/modules              (Status: 301) [Size: 311] [--> http://10.10.10.16/modules/]
/account              (Status: 200) [Size: 5090]
/tests                (Status: 301) [Size: 309] [--> http://10.10.10.16/tests/]
/storage              (Status: 301) [Size: 311] [--> http://10.10.10.16/storage/]
/backend              (Status: 302) [Size: 400] [--> http://10.10.10.16/backend/backend/auth]
/Blog                 (Status: 200) [Size: 4252]
```

Found admin login in /backend

admin:admin credentials worked

# Initial Access

Uploaded a reverse shell script in the media section and executed it to gain a shell

Found some creds in /var/www/html/config/database.php

```bash
'mysql' => [
            'driver'    => 'mysql',
            'host'      => 'localhost',
            'port'      => '',
            'database'  => 'october',
            'username'  => 'october',
            'password'  => 'OctoberCMSPassword!!',
            'charset'   => 'utf8',
            'collation' => 'utf8_unicode_ci',
            'prefix'    => '',
        ],

        'pgsql' => [
            'driver'   => 'pgsql',
            'host'     => 'localhost',
            'port'     => '',
            'database' => 'database',
            'username' => 'root',
            'password' => '',
            'charset'  => 'utf8',
            'prefix'   => '',
            'schema'   => 'public',
        ],

        'sqlsrv' => [
            'driver'   => 'sqlsrv',
            'host'     => 'localhost',
            'port'     => '',
            'database' => 'database',
            'username' => 'root',
            'password' => '',
            'prefix'   => '',
        ],
```

Creds obtained from mysql database

```bash
mysql> select * from users;
select * from users;
+----+----------+--------------------+--------------------------------------------------------------+-----------------+--------------------------------------------------------------+---------------------+-------------+--------------+---------------------+---------------------+---------------------+---------------------+--------------------+---------+------------+---------------------+----------+--------------+
| id | name     | email              | password                                                     | activation_code | persist_code                                                 | reset_password_code | permissions | is_activated | activated_at        | last_login          | created_at          | updated_at          | username           | surname | deleted_at | last_seen           | is_guest | is_superuser |
+----+----------+--------------------+--------------------------------------------------------------+-----------------+--------------------------------------------------------------+---------------------+-------------+--------------+---------------------+---------------------+---------------------+---------------------+--------------------+---------+------------+---------------------+----------+--------------+
|  1 | aaa      | test@test.com      | $2y$10$4BjH4v.qVfYdQvQDE92D1.WeEeDKk/KnF7o0tmwQGHsNYoKsuomZO | NULL            | NULL                                                         | NULL                | NULL        |            1 | 2017-04-20 19:20:52 | NULL                | 2017-04-20 19:20:47 | 2017-04-20 19:20:52 | test@test.com      | aaa     | NULL       | NULL                |        0 |            0 |
|  2 | test     | test@aaa.com       | $2y$10$osIpPHjAEF93srSsntD24.P8Rji0PNzbOLz6YtgRKXAcqAPgaH.LW | NULL            | $2y$10$Q4iMpJbtnOPVuS8O0.hEUea94abaMlXnwUnNf3Yvace/7Jiojxkne | NULL                | NULL        |            1 | 2017-04-20 19:21:20 | 2017-04-20 19:21:20 | 2017-04-20 19:21:20 | 2017-04-20 19:21:20 | test@aaa.com       | NULL    | NULL       | 2017-04-20 21:07:12 |        0 |            0 |
|  3 | testuser | testuser@email.com | $2y$10$4hsu6VXmA2rBUaRAvvCjheL2.7ZRoJi8ieyZtYRK0x2hUw0np6nCi | NULL            | $2y$10$SHO.W5BZ3/D8puRXyU0pnuU2f/7Wx98wntUmsiqjIAK21djOqcKVm | NULL                | NULL        |            1 | 2021-10-08 13:09:03 | 2021-10-08 13:10:24 | 2021-10-08 13:09:03 | 2021-10-08 13:10:24 | testuser@email.com | NULL    | NULL       | 2021-10-08 13:32:26 |        0 |            0 |
+----+----------+--------------------+--------------------------------------------------------------+-----------------+--------------------------------------------------------------+---------------------+-------------+--------------+---------------------+---------------------+---------------------+---------------------+--------------------+---------+------------+---------------------+----------+--------------+
```

# Privilege Escalation

## Notes

-