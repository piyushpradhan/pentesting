# Popcorn - Linux

## Enumeration

nmap scan

```bash
------------------------------------------------------------                                           
        Threader 3000 - Multi-threaded Port Scanner                                                    
                       Version 1.0.7                                                                   
                   A project by The Mayor                                                              
------------------------------------------------------------                                           
Enter your target IP address or URL here: 10.10.10.6                                                   
------------------------------------------------------------                                           
Scanning target 10.10.10.6                                                                             
Time started: 2021-09-14 18:35:09.677385                                                               
------------------------------------------------------------                                           
Port 22 is open                                                                                        
Port 80 is open                                                                                        
Port scan completed in 0:01:10.526529                                                                  
------------------------------------------------------------                                           
Threader3000 recommends the following Nmap scan:                                                       
************************************************************                                           
nmap -p22,80 -sV -sC -T4 -Pn -oA 10.10.10.6 10.10.10.6                                                 
************************************************************                                           
Would you like to run Nmap or quit to terminal?                                                        
------------------------------------------------------------                                           
1 = Run suggested Nmap scan                                                                            
2 = Run another Threader3000 scan                                                                      
3 = Exit to terminal                                                                                   
------------------------------------------------------------                                           
Option Selection: 1                                                                                    
nmap -p22,80 -sV -sC -T4 -Pn -oA 10.10.10.6 10.10.10.6                                                 
Starting Nmap 7.92 ( https://nmap.org ) at 2021-09-14 18:36 IST                                        
Nmap scan report for popcorn.htb (10.10.10.6)                                                          
Host is up (0.20s latency).                                                                            
                                                                                                       
PORT   STATE SERVICE VERSION                                                                           
22/tcp open  ssh     OpenSSH 5.1p1 Debian 6ubuntu2 (Ubuntu Linux; protocol 2.0)                        
| ssh-hostkey:                                                                                         
|   1024 3e:c8:1b:15:21:15:50:ec:6e:63:bc:c5:6b:80:7b:38 (DSA)                                         
|_  2048 aa:1f:79:21:b8:42:f4:8a:38:bd:b8:05:ef:1a:07:4d (RSA)                                         
80/tcp open  http    Apache httpd 2.2.12 ((Ubuntu))                                                    
|_http-server-header: Apache/2.2.12 (Ubuntu)                                                           
|_http-title: Site doesn't have a title (text/html).                                                   
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel                                                
                                                                                                       
Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .         
Nmap done: 1 IP address (1 host up) scanned in 14.02 seconds
```

![Untitled](Popcorn%20-%20Linux%205dda0819aead4250bf9d67719a8aff42/Untitled.png)

```bash
Database: information_schema              
[28 tables]                               
+---------------------------------------+ 
| CHARACTER_SETS                        | 
| COLLATIONS                            | 
| COLLATION_CHARACTER_SET_APPLICABILITY | 
| COLUMNS                               | 
| COLUMN_PRIVILEGES                     | 
| ENGINES                               | 
| EVENTS                                | 
| FILES                                 | 
| GLOBAL_STATUS                         | 
| GLOBAL_VARIABLES                      | 
| KEY_COLUMN_USAGE                      | 
| PARTITIONS                            | 
| PLUGINS                               | 
| PROCESSLIST                           | 
| PROFILING                             | 
| REFERENTIAL_CONSTRAINTS               | 
| ROUTINES                              | 
| SCHEMATA                              | 
| SCHEMA_PRIVILEGES                     | 
| SESSION_STATUS                        | 
| SESSION_VARIABLES                     | 
| STATISTICS                            | 
| TABLES                                | 
| TABLE_CONSTRAINTS                     | 
| TABLE_PRIVILEGES                      | 
| TRIGGERS                              | 
| USER_PRIVILEGES                       | 
| VIEWS                                 | 
+---------------------------------------+ 
                                          
Database: torrenthoster                   
[8 tables]                                
+---------------------------------------+ 
| log                                   | 
| ban                                   | 
| categories                            | 
| comments                              | 
| namemap                               | 
| news                                  | 
| subcategories                         | 
| users                                 | 
+---------------------------------------+
```

```bash
Database: torrenthoster
Table: users
[1 entry]
+----+----------------------+---------------------+----------------------------------+----------+-----------+---------------------+
| id | email                | joined              | password                         | userName | privilege | lastconnect         |
+----+----------------------+---------------------+----------------------------------+----------+-----------+---------------------+
| 3  | admin@yourdomain.com | 2007-01-06 21:12:46 | d5bfedcee289e5e05b86daad8ee3e2e2 | Admin    | admin     | 2007-01-06 21:12:46 |
+----+----------------------+---------------------+----------------------------------+----------+-----------+---------------------+
```

## Initial access

![Untitled](Popcorn%20-%20Linux%205dda0819aead4250bf9d67719a8aff42/Untitled%201.png)

## Privilege Escalation

`www-data@popcorn:~$ find /home -ls
 89588    4 drwxr-xr-x   3 root     root         4096 Mar 17  2017 /home
    39    4 drwxr-xr-x   3 george   george       4096 Mar 17  2017 /home/george
    76    4 -rw-r--r--   1 george   george        220 Mar 17  2017 /home/george/.bash_logout
    82    4 -rw-r--r--   1 george   george       3180 Mar 17  2017 /home/george/.bashrc
 42885  832 -rw-r--r--   1 george   george     848727 Mar 17  2017 /home/george/torrenthoster.zip
 48951    4 drwxr-xr-x   2 george   george       4096 Mar 17  2017 /home/george/.cache
 42883    0 -rw-r--r--   1 george   george          0 Mar 17  2017 /home/george/.cache/motd.legal-displayed
 42884    0 -rw-r--r--   1 george   george          0 Mar 17  2017 /home/george/.sudo_as_admin_successful
  2210    4 -rw-r--r--   1 george   george         33 Mar 17  2017 /home/george/user.txt
 43648    4 -rw-------   1 root     root           19 May  5  2017 /home/george/.nano_history
 44232    4 -rw-------   1 root     root         1571 Mar 17  2017 /home/george/.mysql_history
   499    4 -rw-------   1 root     root         2769 May  5  2017 /home/george/.bash_history
   107    4 -rw-r--r--   1 george   george        675 Mar 17  2017 /home/george/.profile`

The most suspicious file here was `/home/george/.cache/motd.legal-displayed`
 since it indicated the existence of the Linux PAM module. I went ahead 
and checked for the installed version of the Linux PAM module installed 
on the popcorn host:

`www-data@popcorn:/dev/shm$ dpkg -l | grep pam
ii  libpam-modules                      1.1.0-2ubuntu1                    Pluggable Authentication Modules for PAM
ii  libpam-runtime                      1.1.0-2ubuntu1                    Runtime support for the PAM library
ii  libpam0g                            1.1.0-2ubuntu1                    Pluggable Authentication Modules library
ii  python-pam                          0.4.2-12ubuntu3                   A Python interface to the PAM library`

**Didn't  work**

USED A DIRTY COW EXPLOIT

![Untitled](Popcorn%20-%20Linux%205dda0819aead4250bf9d67719a8aff42/Untitled%202.png)