# Napping

Author: Vulnhub
Difficulty: 2
Key takeaway: Try tabnabbing if any anchor tag has target set as “_blank” and we can somehow inject links to the website
Tags: _blank, href, link, python, tab nabbing
Type: Linux

# Enumeration

- portscan

```bash
PORT   STATE SERVICE VERSION
22/tcp open  ssh     OpenSSH 8.2p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0)
| ssh-hostkey:
|   3072 24:c4:fc:dc:4b:f4:31:a0:ad:0d:20:61:fd:ca:ab:79 (RSA)
|   256 6f:31:b3:e7:7b:aa:22:a2:a7:80:ef:6d:d2:87:6c:be (ECDSA)
|_  256 af:01:85:cf:dd:43:e9:8d:32:50:83:b2:41:ec:1d:3b (ED25519)
80/tcp open  http    Apache httpd 2.4.41 ((Ubuntu))
| http-cookie-flags:
|   /:
|     PHPSESSID:
|_      httponly flag not set
|_http-server-header: Apache/2.4.41 (Ubuntu)
|_http-title: Login
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel
```

- dirscan

```bash
kali@kali  ~/vulnhub/napping  feroxbuster -u http://napping.vuln -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -x php,txt,html -q --output dirscan.txt
200       37l       82w     1219c http://napping.vuln/index.php
302        0l        0w        0c http://napping.vuln/welcome.php
200       41l      104w     1566c http://napping.vuln/register.php
200        0l        0w        0c http://napping.vuln/config.php
302        0l        0w        0c http://napping.vuln/logout.php
403        9l       28w      277c http://napping.vuln/server-status
```

- there’s a config.php file but it’s empty
- in the <a> tag target=”_blank” is set
- using tab nabbing to get creds from login form

# Initial Access

- found daniel’s creds : C@ughtm3napping123
- Found adrian’s creds in config.php

```php
<?php
/* Database credentials. Assuming you are running MySQL
server with default setting (user 'root' with no password) */
define('DB_SERVER', 'localhost');
define('DB_USERNAME', 'adrian');
define('DB_PASSWORD', 'P@sswr0d456');
define('DB_NAME', 'website');

/* Attempt to connect to MySQL database */
$mysqli = new mysqli(DB_SERVER, DB_USERNAME, DB_PASSWORD, DB_NAME);

// Check connection
if($mysqli === false){
    die("ERROR: Could not connect. " . $mysqli->connect_error);
}
?>
```

# Privilege Escalation

# Notes

-