# Spiking

In spiking, we take one command at a time, throw a bunch of characters at it and check if buffer overflows or if it crashes. If it does, then the program is vulnerable.

- Turn off Real-time protection on Windows Defender
- Start Vulnserver and Immunity Debugger as Administrator
- Attack Vulnserver to Immunity Debugger and start debugging

## **Connecting to Vulnserver**

- Use netcat to connect

```jsx
nc -nv <windows_ip> 9999
```

- by default, vulnserver runs on port 9999

## STAT

we'll use generic_send_tcp to send characters to STATS command 

- make a stats.spk

```jsx
s_readline(); 
s_string("STAT "); 
s_string_variable("0"); 
```

- run

    ```bash
    generic_send_tcp <windows_ip> 9999 stats.spk 0 0
    ```

- This program (probably Vulnserver) isn't vulnerable to STAT

## TRUN

- make a trun.spk

```bash
s_readline(); 
s_string("TRUN"); 
s_string_variable("0"); 
```

- run

```bash
generic_send_tcp <windows_ip> 9999 stats.spk 0 0
```

- the program crashed, we get some details about the registers on Immunity Debugger

![Spiking%201c6e1c9e47a843e4a4c5ef119d00d295/Untitled.png](Spiking%201c6e1c9e47a843e4a4c5ef119d00d295/Untitled.png)

- The EIP is overwritten - the overflow worked