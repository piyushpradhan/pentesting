# Information Gathering and Vulnerability Scanning

## Passive Information Gathering
#### Google hacking
- Google search to find a website sub domains
`site:website.com`
- Google filtype and intitle
`intitle:"netbotz appliance" "OK" -filetype:pdf`
- Google inurl
`inurl:"level/15/sexec/-/show"`
- [Google hacking database](https://www.exploit-db.com/google-hacking-database/)

#### SSL certificate testing
https://www.ssllabs.com/ssltest/analyze.html

#### Email harvesting
Simply Email
```
git clone https://github.com/killswitch-GUI/SimplyEmail.git
./SimpleEmail.py -all -e TARGET-DOMAIN
```

#### Whois enumeration
`whois domain-name.org` </br>
`whois $ip`

#### Banner grabbing
`nc -v $ip 25`</br>
`telnet $ip 25` </br>
`nc TARGET-IP 80` </br>

#### Recon-ng full fledged web reconnaissance framework written in Python
```
cd /opt;
git clone https://LaNMaSteR53@bitbucket.org/LaNMaSteR53/recon-ng.git
cd /opt/recon-ng
./recon-ng
show modules
help
```

## Active Information Gathering

- Netcat port scanning
```
nc -nvv -w 1 -z $ip 3388-3390
```
- Discover active IPs using ARP on the network
```
arp-scan $ip/24
```
- Discover who else is on the network
```
netdiscover
```
- Discover IP Mac and Mac vendors from ARP
```
netdiscover -r $ip/24
```
- Quick traceroute scan
```
nmap -sn --traceroute $ip
```

## Enumeration

#### DNS enumeration
```
nmap -f --dns-server <dns server ip> <target ip range>
```

#### Host lookup
```
host -t ns website.com
```

#### Reverse lookup brute force - Find domains in the same range
```
for ip in $(req 155 190);do host 50.7.67.$ip;done | grep -v "not found"
```

#### Perform DNS IP lookup
```
dig a domain-name.com @nameserver
```

#### Perform MX record lookup
```
dig mx domain-name @nameserver
```

#### Perform zone transfer
```
dig axfr domain-name.com @nameserver
```

#### Windows DNS Zone transfer
```
nslookup -> set type=any -< ls -d website.com
```

#### Linux DNS Zone transfer
```
dig axfr website.com @nameserver
```

#### DNSRecon DNS brute force
```
dnsrecon -d TARGET -D /usr/share/wordlists/dnsmap.txt -t std --xml output.xml
````

#### DNSRecon DNS List of megacorp
```
dnsrecon -d megacorpone.com -t axfr
```

#### DNSEnum
```
dnsenum zontransfer.me
```

## Nmap enumeration scripts
```bash
# Nmap discovery
# https://nmap.org/nsedoc/categories/discovery.html

# Nmap port version detection MAX Power
nmap -vvv -A --reason --script="+(safe or default) and not broadcast" -p <port> <host>

# NFS (Network File system enumeration)
# SHow mountable NFS SHares
nmap -sV --script=nfs-showmount $ip

# RPC (Remote Procedure Call) Enumeration
# Connect to an RPC Share without a username and password and enumerate privileges
rpcclient --user="" --command=enumprivs -N $ip
# Connect to an RPC Share with a username and enumerate privileges
rpcclient --user="username" --command=enumprivs $ip

# SMTP Enumeration
# Verify SMIP Port using netcat
nc -nv $ip 25
```

#### POP3 Enumeration - Reading other people's mail - May find usernames and passwords for email accounts
```
root@kali:~# telnet $ip 110
+OK beta POP3 server (JAMES POP3 Server 2.3.2) ready
USER billydean    
+OK
PASS password
+OK Welcome billydean

list

+OK 2 1807
1 786
2 1021

retr 1

+OK Message follows
From: jamesbrown@motown.com
Dear Billy Dean,

Here is your login for remote desktop ... try not to forget it this time!
username: billydean
password: PA$$W0RD!Z
```
