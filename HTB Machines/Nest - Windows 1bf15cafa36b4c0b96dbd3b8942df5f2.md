# Nest - Windows

## Enumeration

scanning for open ports  → only port 445 was open

```bash
Host discovery disabled (-Pn). All addresses will be marked 'up' and scan times will be slower.
Starting Nmap 7.91 ( https://nmap.org ) at 2021-09-10 08:32 EDT
Initiating Connect Scan at 08:32
Scanning nest.htb (10.10.10.178) [65535 ports]
Discovered open port 445/tcp on 10.10.10.178
Connect Scan Timing: About 6.20% done; ETC: 08:40 (0:07:49 remaining)
Connect Scan Timing: About 22.55% done; ETC: 08:36 (0:03:30 remaining)
Connect Scan Timing: About 33.80% done; ETC: 08:36 (0:02:58 remaining)
Connect Scan Timing: About 45.72% done; ETC: 08:36 (0:02:24 remaining)
Connect Scan Timing: About 56.78% done; ETC: 08:36 (0:01:55 remaining)
Connect Scan Timing: About 65.62% done; ETC: 08:37 (0:01:35 remaining)
Connect Scan Timing: About 76.09% done; ETC: 08:37 (0:01:06 remaining)
Completed Connect Scan at 08:36, 258.58s elapsed (65535 total ports)
Nmap scan report for nest.htb (10.10.10.178)
Host is up, received user-set (0.18s latency).
Scanned at 2021-09-10 08:32:24 EDT for 259s
Not shown: 65534 filtered ports
Reason: 65534 no-responses
PORT    STATE SERVICE      REASON
445/tcp open  microsoft-ds syn-ack
```

Running a detailed scan on port 445

```bash
PORT    STATE SERVICE       REASON  VERSION
445/tcp open  microsoft-ds? syn-ack

Host script results:
|_clock-skew: 5h34m43s
| p2p-conficker:
|   Checking for Conficker.C or higher...
|   Check 1 (port 28056/tcp): CLEAN (Timeout)
|   Check 2 (port 65067/tcp): CLEAN (Timeout)
|   Check 3 (port 17014/udp): CLEAN (Timeout)
|   Check 4 (port 22397/udp): CLEAN (Timeout)
|_  0/4 checks are positive: Host is CLEAN or ports are blocked
| smb2-security-mode:
|   2.02:
|_    Message signing enabled but not required
| smb2-time:
|   date: 2021-09-10T18:14:19
|_  start_date: 2021-09-10T17:44:52
```

tried to connect to port 4386 using telnet

```bash
┌──(kali㉿kali)-[~/hackthebox/nest]
└─$ telnet 10.10.10.178 4386
Trying 10.10.10.178...
Connected to 10.10.10.178.
Escape character is '^]'.

HQK Reporting Service V1.2

>help

This service allows users to run queries against databases using the legacy HQK format

--- AVAILABLE COMMANDS ---

LIST
SETDIR <Directory_Name>
RUNQUERY <Query_ID>
DEBUG <Password>
HELP <Command>
```